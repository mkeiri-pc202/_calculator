# 電卓プログラム 仕様書（テンプレート）

バージョン: 0.1  
作成日: [2025/10/17]  
作成者: [作成者名 / 松本経理ビジネス専門学校 Team A ]  
リポジトリ: [mkeiri-pc202/_calculator](https://github.com/mkeiri-pc202/_calculator)

---

## 1. 概要
松本経理ビジネス専門学校の職業訓練の一環として、Pythonを使用したプログラムの作成を通じて、プログラミングの理解を深めることを目的として作成しています。

### 1.1 目的
- 電卓の機能の動作を目的として作成しております。
- 四則演算（加算、減算、乗算、除算）、ルート、パーセンテージ、丸括弧（）、クリア(C)、小数点以下の計算
- 数字、演算子のキーボード入力

---

## 2. 用語定義
- 数値 1,2,3 など
- 演算子,: +, -, ×, ÷ など

---

## 3. 高レベル要件（目的・目標）
- 正確さ: 標準的な数値表現で正しい結果を返す
- 耐久性: 異常入力に対してエラーを返すこと

---

## 4. 機能要件

### 4.1 基本機能（必須）
- 加算 (a + b)
- 減算 (a - b)
- 乗算 (a * b)
- 除算 (a / b) — 0 除算時の挙動を定義する
- 小数の取り扱い
- 正負（負数）の入力と計算
- 演算子優先順位（乗除が加減より優先）
- 括弧によるグルーピング ( )
- 画面のクリア(C)

### 4.2 追加機能（任意／優先度をつける）
- 平方根（√）
- パーセンテージ(%)
- 文字列入力（例: "2+3*4" の解析）

### 4.3 非機能要件
- 精度: 19桁まで対応している
- セキュリティ: sympifyを使用している。（悪意のあるコードの実行を避けるため、evalの使用を避けた）
---

## 5. ユーザーインターフェース（UI / UX）
- tkinterを使用して作成している

### 5.1 コマンドライン (CLI)
- 起動方法: app.pyを実行する

### 5.2 GUI / Web
- 起動方法:app.exeを実行する
- 表示要素: 入力欄、結果表示
- キーボード操作: 数値キーで入力、Enterで確定、Backspaceでクリア、Cでクリア

---

## 6. 入出力仕様

### 6.1 入力形式
- 文字列式（例: "3 + 4 * (2 - 1)"）
- 実数表現のルール（小数点記号は利用可、指数表記は未対応）

### 6.2 出力形式
- デフォルト: 数値（例: 7）
- エラー時: 文字列'エラー'を返します

---

## 7. エラー処理とメッセージ
- すべてのエラーに対して、文字列'エラー'を返します

---

## 8. 例（ユースケース）
- 入力: "2+3*4" → 出力: 14
- 入力: "(1+2)/3" → 出力: 1
- 入力: "10/0" → 出力: エラー
- 入力: 10%  → 出力: 0.1
- 入力: 10±  → 出力: (-10)
- 入力: (-10)± → 出力: 10
- 入力: √2 → 出力: 1.4142...

---

## 9. 内部設計（アーキテクチャ）
- モジュール構成
  - app.py(ボタンの作成、結果表示画面の作成、ボタンとキーボードの紐づけ）
  - calc.py(計算の実行）
  - click_event.py(入力された文字列を計算可能な値に変換）

### 9.1 データフロー（簡易）
入力 → Lexer（トークン化）→ Parser（AST）→ Evaluator（計算）→ 出力表示

---

## 10. テスト計画
- ユニットテスト
  - Lexer: トークン化の網羅テスト
  - Parser: 構文ツリー生成テスト
  - Evaluator: 演算の正しさテスト（境界値含む）
- 統合テスト
  - 複雑な式の評価（ネスト・優先順位の確認）
- 回帰テスト
  - 既知の不具合を防ぐテストケース
- 自動テスト実行コマンド例:
  - `npm test` / `pytest` / `go test` 等

テストデータ例:
- 正常系: "3+5", "2*(3+4)", "1.5+2.25"
- 異常系: ")", "2++2", "10/0"

---

## 11. 受け入れ基準
- 定義された基本機能が全て正常に動作すること
- テストスイートが全てパスすること
- 重大なエラー（クラッシュ、未処理例外）がないこと
- ドキュメント（README, 仕様書）が整備されていること

---

## 12. ロードマップ / バージョニング
- v0.1: 基本四則 + 小数 + CLI
- v0.2: 括弧、履歴、メモリ機能
- v1.0: GUI/ウェブ版、国際化、安定リリース

---

## 13. ビルド・実行方法（テンプレート）
- 要求環境: [言語/バージョン例]
- ビルド:
  - 例: `make build` / `go build ./...` / `npm run build`
- 実行:
  - CLI: `./calculator "2+3"`
  - REPL: `./calculator` → プロンプトで式を入力
- テスト:
  - `make test` / `npm test` / `pytest`

---

## 14. 依存関係
- ランタイム / 言語バージョン
- 使用ライブラリ（例: big-decimal、mathjs 等）

---

## 15. セキュリティと注意点
- 入力式をそのまま eval に流用しない
- 外部からの式評価時にコマンド実行が起きないよう完全に分離する

---

## 16. 付録
- 変更履歴（Changelog）
- 既知の制限／既知のバグ
- 参考資料（演算子優先順位表、IEEE754）
- 担当者一覧 / 連絡先

---

## 17. TODO（テンプレート）
- [ ] 精度要件の確定（float vs decimal）
- [ ] ローカライズ対応の方針決定
- [ ] GUI ワイヤーフレーム作成
- [ ] CI での自動テスト導入

---

（終わり）
