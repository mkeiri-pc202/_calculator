<style>
table, th, td {
    font-size: 50%;
}
</style>

# 電卓プログラム テスト仕様書

バージョン: 1.1 
最終更新日: [2025/11/04]
作成日: [2025/10/24] 
作成者: [作成者名 / 松本経理ビジネス専門学校 Team A ]  
リポジトリ: [mkeiri-pc202/_calculator](https://github.com/mkeiri-pc202/_calculator)

---

## 1.概要
- 対応プログラム: 電卓(_calculator)
- 対象機能: 四則演算、入力検証、エラーハンドリング
- テスト目的: 各機能が仕様通りに動作することを確認する

## 2.テスト環境
- OS: Windows 11 Education(24H2)
- Python: 3.13.9
- エディタ: Visual Studio Code 1.105.1
- テストフレームワーク: pytest
- 実行方法: ターミナルにて pytest を実行
- 依存ライブラリ:
- バージョン管理: Github
- 実行端末: CPU: AMD Athlon Silver 3050U with Radeon Graphics(2.30 GHz) RAM: 8.0GB

## 3.テスト項目一覧
### 3.1 単体テスト一覧
- 対象ファイル:app.py テストファイル:test_app.py
![alt text](image-2.png)
| No. | テスト関数                               | テスト項目名                                            | テスト観点 | 事前条件(初期値)        | 入力値           | 期待結果                                  | 実行結果                                  | 判定 |
|-----|-------------------------------------|---------------------------------------------------|-------|------------------|---------------|---------------------------------------|---------------------------------------|----|
| 1   | test_handle_click_number            | 数字ボタンのクリックで正しい文字がhandle_inputに渡される                | 正常系   | screen = ""(空文字) | 1             | handle_input("1", screen, state)が呼ばれる | handle_input("2", screen, state)が呼ばれる | OK |
| 2   | test_handle_click_operator          | 演算子ボタンのクリックで正しい文字がhandle_inputに渡される               | 正常系   | screen = ""(空文字) | +             | handle_input("+", screen, state)が呼ばれる | handle_input("+", screen, state)が呼ばれる | OK |
| 3   | test_handle_key_return              | Enterキーで"="がhandle_inputに渡される                     | 正常系   | screen = "1+2"   | ＝             | handle_input("=", screen, state)が呼ばれる | handle_input("=", screen, state)が呼ばれる | OK |
| 4   | test_handle_key_backspace_number    | BackSpaceキー入力(screenの末尾が数字の場合、末尾1文字削除)            | 正常系   | screen = "123"   | BackSpace, "" | screen = "12"に変更                      | screen = "13"に変更                      | OK |
| 5   | test_handle_key_backspace_operator  | BackSpaceキー入力(screenの末尾が演算子の場合、末尾1文字削除)           | 正常系   | screen = "1+"    | BackSpace, "" | screen = "1"に変更                       | screen = "1"変更                        | OK |
| 6   | test_handle_key_backspace_evaluated | BackSpace キーでjust_evaluatedがFalseに設定される           | 正常系   | screen = "123"   | BackSpace, "" | just_evaluated = False                | just_evaluated = False                | OK |
| 7   | test_handle_key_allowed_char        | 許可された文字が入力されたとき、handle_inputが呼ばれる                 | 正常系   | screen = ""(空文字) | +             | handle_input("+", screen, state)が呼ばれる | handle_input("+", screen, state)が呼ばれる | OK |
| 8   | test_handle_key_disallowed_char     | 許可されていない文字が入力された場合は<br/>handle_inputは呼ばれず、何も起こらない | 準正常系  | screen = ""(空文字) | a             | handle_input("a", screen, state)が呼ばれる | handle_input("a", screen, state)が呼ばれる | OK |
| 9   | test_handle_key_open_parentheses    | 前括弧が呼ばれたときhandle_inputが呼ばれる                       | 正常系   | screen = ""(空文字) | (             | handle_input("(", screen, state)が呼ばれる | handle_input("(", screen, state)が呼ばれる | OK |
| 10  | test_handle_key_cloes_parentheses   | 後括弧が呼ばれたときhandle_inputが呼ばれる                       | 正常系   | screen = ""(空文字) | )             | handle_input(")", screen, state)が呼ばれる | handle_input(")", screen, state)が呼ばれる | OK |
| 11  | test_handle_key_decimal_point       | 小数点が呼ばれたときhandle_inputが呼ばれる                       | 正常系   | screen = ""(空文字) | .             | handle_input(".", screen, state)が呼ばれる | handle_input(".", screen, state)が呼ばれる | OK |
| 12  | test_handle_key_root                | √が呼ばれたときhandle_inputが呼ばれる                         | 正常系   | screen = ""(空文字) | √             | handle_input("√", screen, state)が呼ばれる | handle_input("√", screen, state)が呼ばれる | OK |
| 13  | test_handle_key_hat                 | ^が呼ばれたときhandle_inputが呼ばれる                         | 正常系   | screen = ""(空文字) | ^             | handle_input("^", screen, state)が呼ばれる | handle_input("^", screen, state)が呼ばれる | OK |
| 14  | test_handle_key_plus_minus          | ±が呼ばれたときhandle_inputが呼ばれる                         | 正常系   | screen = ""(空文字) | ±             | handle_input("±", screen, state)が呼ばれる | handle_input("±", screen, state)が呼ばれる | OK |
| 15  | test_handle_key_E                   | Eが呼ばれたときhandle_inputが呼ばれる                         | 正常系   | screen = ""(空文字) | E             | handle_input("E", screen, state)が呼ばれる | handle_input("E", screen, state)が呼ばれる | OK |
| 16  | test_handle_key_blank               | 空文字が呼ばれたときhandle_inputは呼ばれない                      | 準正常系  | screen = ""(空文字) | ""            | handle_inputは呼ばれない。戻り値はNone           | handle_inputが呼ばれる                     | OK |

- 対象ファイル:input_handler.py テストファイル:test_input_handler.py
![alt text](image.png)
| No. | テスト関数                                                          | テスト項目名                               | テスト観点 | 事前条件(初期値)                                                                                                                                      | 入力値               | 期待結果               | 実行結果   | 判定 |
|-----|----------------------------------------------------------------|--------------------------------------|-------|------------------------------------------------------------------------------------------------------------------------------------------------|-------------------|--------------------|--------|----|
| 1   | test_button_multiply                                           | ×ボタン表記変換(GUI表示→内部)                   | 正常系   | 2                                                                                                                                              | ×                 | 2*                 |        |    |
| 2   | test_button_divide                                             | ÷ボタン表記変換(GUI表示→内部)                   | 正常系   | 2                                                                                                                                              | ÷                 | 2/                 |        |    |
| 3   | test_allow_len_number                                          | 19文字以上の入力(数字)                        | 異常系   | 111111111111111111                                                                                                                             | 9                 | 111111111111111111 |        |    |
| 4   | test_allow_len_operator                                        | 19文字以上の入力(演算子)                       | 異常系   | 111111111111111111                                                                                                                             | +                 | 111111111111111111 |        |    |
| 5   | test_allow_len_clear                                           | 19文字以上の入力時のクリア入力許可                   | 正常系   | 111111111111111111                                                                                                                             | C                 | ""(空文字)            |        |    |
| 6   | test_number_input                                              | 数字入力(単独)                             | 正常系   | ""(空文字)                                                                                                                                        | 1                 | 1                  |        |    |
| 7   | test_continuous_number_input_                                  | 数字入力(連続入力)                           | 正常系   | 1                                                                                                                                              | 1                 | 11                 |        |    |
| 8   | test_number_input_decimals                                     | 数字入力(小数点の後)                          | 正常系   | 0.                                                                                                                                             | 1                 | 0.1                |        |    |
| 9   | test_number_input_operator                                     | 数字入力(演算子の後)                          | 正常系   | 1+                                                                                                                                             | 2                 | 1+2                |        |    |
| 10  | test_number_input_reset                                        | 数字入力(計算後の新たな入力)                      | 正常系   | 1+2=3                                                                                                                                          | 4                 | 4                  |        |    |
| 11  | test_number_input_zero                                         | 数字入力(０の後の入力)                         | 正常系   | 0                                                                                                                                              | 5                 | 5                  |        |    |
| 12  | test_number_input_zero2                                        | 数字入力(四則演算子直後が0の後の入力)                 | 準正常系  | 5+0                                                                                                                                            | 6                 | 5+6                |        |    |
| 13  | test_number_input_open_parenthesis                             | 数字入力(直前が括弧)                          | 正常系   | (                                                                                                                                              | 7                 | (7                 |        |    |
| 14  | test_clear_input_number                                        | クリア入力(数字）                            | 正常系   | 90                                                                                                                                             | C                 | ""(空文字)            |        |    |
| 15  | test_clear_input_operator                                      | クリア入力(演算子)                           | 正常系   | √                                                                                                                                              | C                 | ""(空文字)            |        |    |
| 16  | test_clear_input_formula                                       | クリア入力(計算式)                           | 正常系   | (1+2)*√3                                                                                                                                       | C                 | ""(空文字)            |        |    |
| 17  | test_clear_input_reset                                         | クリア入力(評価後)                           | 正常系   | 4+5*6=34                                                                                                                                       | C                 | ""(空文字)            |        |    |
| 18  | test_equal_input                                               | イコール入力(式の最後)                         | 正常系   | 1+2                                                                                                                                            | =                 | 3                  |        |    |
| 19  | test_equal_input_operator                                      | イコール入力(演算子で終了)                       | 準正常系  | 3+                                                                                                                                             | =                 | 3+(無視)             |        |    |
| 20  | test_equal_input_parentheses                                   | イコール入力(括弧補完)                         | 準正常系  | ((2+3                                                                                                                                          | =                 | 5                  |        |    |
| 21  | test_equal_input_exc                                           | イコール入力(例外発生)                         | 異常系   | abc+5                                                                                                                                          | =                 | エラー                |        |    |
| 22  | test_equal_input_parentheses_formura                           | イコール入力(括弧で囲まれた式)                     | 正常系   | (5+3)                                                                                                                                          | =                 | 8                  |        |    |
| 23  | test_equal_input_parentheses_formula_root_percent              | イコール入力(括弧で囲まれた式で√や%を含む)              | 正常系   | (√2+5％)                                                                                                                                        | =                 | エラー                |        |    |
| 24  | test_equal_input_clear                                         | イコール入力(クリア入力後にイコール)                  | 正常系   | C                                                                                                                                              | =                 | エラー                |        |    |
| 25  | test_percent_input_number                                      | パーセント入力(数字の後)                        | 正常系   | 5                                                                                                                                              | %                 | 0.05               |        |    |
| 26  | test_percent_input_exc                                         | パーセント入力(文字列混入)                       | 異常系   | abc                                                                                                                                            | %                 | エラー                | abc    | NG |
| 27  | test_percent_input_blank                                       | パーセント入力(空文字)                         | 準正常系  | ""(空文字)                                                                                                                                        | %                 | ””（無視)             |        |    |
| 28  | test_percent_input_operator                                    | パーセント入力(演算子のみ)                       | 準正常系  | √                                                                                                                                              | %                 | √（無視)              |        |    |
| 29  | test_percent_input_halfway                                     | パーセント入力(数式の途中)                       | 正常系   | 6+7*                                                                                                                                           | %                 | 6+7*(無視)           |        |    |
| 30  | test_percent_input_parentheses                                 | パーセント入力(括弧付き)                        | 正常系   | (8)                                                                                                                                            | %                 | (0.08)             |        |    |
| 31  | test_root_input                                                | ルート入力(単独)                            | 正常系   | ""(空文字)                                                                                                                                        | √                 | √                  |        |    |
| 32  | test_root_number_input                                         | ルート入力後に数字入力                          | 正常系   | √                                                                                                                                              | 2                 | √2                 |        |    |
| 33  | test_root_input_number                                         | ルート入力(数字の後)                          | 正常系   | 3                                                                                                                                              | √                 | 3√                 |        |    |
| 34  | test_root_input_operator                                       | ルート入力(演算子の後)                         | 正常系   | 2*                                                                                                                                             | √                 | 2*√                |        |    |
| 35  | test_root_input_open_parenthesis                               | ルート入力(前括弧の後)                         | 正常系   | (                                                                                                                                              | √                 | (√                 |        |    |
| 36  | test_double_root_input                                         | ルート入力(2連続ルート入力)                      | 正常系   | √                                                                                                                                              | √                 | √√                 |        |    |
| 37  | test_triple_root_input                                         | ルート入力(3連続ルート入力)                      | 準正常系  | √√                                                                                                                                             | √                 | √√(無視)             |        |    |
| 38  | test_root_input_halfway                                        | ルート入力(数式の途中)                         | 正常系   | 5+3                                                                                                                                            | √                 | 5+3√               |        |    |
| 39  | test_root_input_exc                                            | ルート入力(無効な文字列式の後)                     | 準正常系  | ABC                                                                                                                                            | √                 | エラー                | ABC√   | NG |
| 40  | test_puls_minus_input                                          | プラスマイナス入力(空文字)                       | 準正常系  | ""(空文字)                                                                                                                                        | ±                 | (無視)               |        |    |
| 41  | test_puls_minus_input_minus                                    | プラスマイナス入力(正の整数を負の整数)                 | 正常系   | 1                                                                                                                                              | ±                 | (-1)               |        |    |
| 42  | test_puls_minus_input_minus_decimals                           | プラスマイナス入力(正の小数を負の小数)                 | 正常系   | 0.1                                                                                                                                            | ±                 | (-0.1)             |        |    |
| 43  | test_puls_minus_input_puls                                     | プラスマイナス入力(負の整数を正の整数に戻す)              | 正常系   | (-1)                                                                                                                                           | ±                 | 1                  |        |    |
| 44  | test_puls_minus_input_puls_decimals                            | プラスマイナス入力(負の小数を正の小数に戻す)              | 正常系   | (-0.1)                                                                                                                                         | ±                 | 0.1                |        |    |
| 45  | test_puls_minus_input_operator                                 | プラスマイナス入力(演算子の後)                     | 準正常系  | 2+                                                                                                                                             | ±                 | 2+                 |        |    |
| 46  | test_puls_minus_input_halfway_minus                            | プラスマイナス入力(式の途中(整数))                  | 正常系   | 5*3                                                                                                                                            | ±                 | 5*(-3)             |        |    |
| 47  | test_puls_minus_input_halfway_puls                             | プラスマイナス入力を戻す(式の途中(整数))               | 正常系   | 5*(-3)                                                                                                                                         | ±                 | 5*3                |        |    |
| 48  | test_puls_minus_input_halfway_decimals_minus                   | プラスマイナス入力(式の途中(小数))                  | 正常系   | 6/0.5                                                                                                                                          | ±                 | 6/(-0.5)           |        |    |
| 49  | test_puls_minus_input_halfway_decimals_plus                    | プラスマイナス入力を戻す(式の途中(小数))               | 正常系   | 6/(-0.5)                                                                                                                                       | ±                 | 6/0.5              |        |    |
| 50  | test_puls_minus_input_parentheses_minus                        | プラスマイナス入力(括弧内の数字)                    | 正常系   | (9)                                                                                                                                            | ±                 | ((-9))             | (-9)   | NG |
| 51  | test_puls_minus_input_parentheses_puls                         | プラスマイナス入力を戻す(括弧内の数字)                 | 正常系   | ((-9))                                                                                                                                         | ±                 | (-9)               | ((-9)) | NG |
| 52  | test_open_parenthesis_input                                    | 前括弧 "(" 入力(単独)                       | 正常系   | ""(空文字)                                                                                                                                        | (                 | (                  |        |    |
| 53  | test_open_parenthesis_input_number                             | 前括弧 "(" 入力(数字直後)                     | 正常系   | 1                                                                                                                                              | (                 | 1*(                |        |    |
| 54  | test_open_parenthesis_input_operator                           | 前括弧 "(" 入力(演算子直後)                    | 正常系   | 2+                                                                                                                                             | (                 | 2+(                |        |    |
| 55  | test_open_parenthesis_puls_minus                               | 前括弧 "(" 入力(プラスマイナス変換直後)              | 正常系   | (-3)                                                                                                                                           | (                 | (-3)*(             |        |    |
| 56  | test_open_parenthesis_input_halfway                            | 前括弧 "(" 入力(式の途中)                     | 正常系   | 12+3*                                                                                                                                          | (                 | 12+3*(             |        |    |
| 57  | test_continuous_open_parenthesis_input                         | 前括弧 "(" 入力(2連続前括弧入力)                 | 正常系   | (                                                                                                                                              | (                 | ((                 |        |    |
| 58  | test_open_parenthesis_input_open_parenthesis_and_number        | 前括弧 "(" 入力(前括弧と数字を入力直後)              | 正常系   | (6                                                                                                                                             | (                 | (6*(               |        |    |
| 59  | test_close_parenthesis_input                                   | 後括弧 ")" 入力(単独)                       | 準正常系  | ""(空文字)                                                                                                                                        | )                 | ""(無視)             |        |    |
| 60  | test_close_parenthesis_input_open_parenthesis                  | 後括弧 ")" 入力(前括弧入力直後)                  | 準正常系  | (                                                                                                                                              | )                 | ( (無視)             |        |    |
| 61  | test_close_parenthesis_input_number                            | 後括弧 ")" 入力(数字直後)                     | 準正常系  | 1                                                                                                                                              | )                 | 1 (無視)             |        |    |
| 62  | test_close_parenthesis_input_open_parenthesis_and_number       | 後括弧 ")" 入力(前括弧と数字を入力直後)              | 正常系   | (2                                                                                                                                             | )                 | (2)                |        |    |
| 63  | test_close_parenthesis_input_operator                          | 後括弧 ")" 入力(演算子直後)                    | 準正常系  | √                                                                                                                                              | )                 | √(無視)              |        |    |
| 64  | test_close_parenthesis_input_number_and_operator               | 後括弧 ")" 入力(数字と演算子を入力直後)              | 準正常系  | 9+                                                                                                                                             | )                 | 9+(無視)             |        |    |
| 65  | test_close_parenthesis_input_puls_minus                        | 後括弧 ")" 入力(プラスマイナス変換直後)              | 準正常系  | (-4)                                                                                                                                           | )                 | (-4)(無視)           |        |    |
| 66  | test_parentheses_more_open                                     | 括弧の整合性(前括弧が多い)                       | 準正常系  | (2*(5+3                                                                                                                                        | =                 | 16                 |        |    |
| 67  | test_parentheses_more_close                                    | 括弧の整合性(後括弧が多い)                       | 異常系   | (2*(5+3)))                                                                                                                                     | =                 | エラー                | 16     | NG |
| 68  | test_E_input                                                   | 指数表記(E)入力(単独)                        | 正常系   | ""(空文字)                                                                                                                                        | E                 | (無視)               |        |    |
| 69  | test_E_input_operator                                          | E入力(演算子のみの後)                         | 準正常系  | √                                                                                                                                              | E                 | √(無視)              |        |    |
| 70  | test_E_input_number                                            | E入力(数字のみの後)                          | 正常系   | 2                                                                                                                                              | E                 | 2E                 |        |    |
| 71  | test_puls_input_number_and_E                                   | 数字とEの後に+入力                           | 正常系   | 2E                                                                                                                                             | +                 | 2E+                |        |    |
| 72  | test_minus_input_number_and_E                                  | 数字とEの後に-入力                           | 正常系   | 2E                                                                                                                                             | -                 | 2E-                |        |    |
| 73  | test_invalid_operator_input_number_and_E                       | 数字とEの後に+,-以外の演算子入力                   | 準正常系  | 2E                                                                                                                                             | /                 | 2E(無視)             |        |    |
| 74  | test_evaluation_E_without_exponent                             | E入力後、追加せずに評価                         | 準正常系  | 2E                                                                                                                                             | =                 | 3E(無視)             |        |    |
| 75  | test_evaluation_number_and_E                                   | 数字とEの後に数字を入力し評価                      | 正常系   |     screen.set("2E") <br/>    handle_input("3", screen, state)<br/>    monkeypatch.setattr("input_handler.format_result", lambda expr: "2000") | 3, =              | 2000               |        |    |
| 76  | test_plus_minus_with_E_formula                                 | Eを含む式をプラスマイナス変換                      | 準正常系  | 3E4                                                                                                                                            | ±                 | 3E(-4)             |        |    |
| 77  | test_percent_with_E_formula                                    | Eを含む式をパーセント変換                        | 準正常系  | 3E(-4)                                                                                                                                         | ±                 | 3E4                |        |    |
| 78  | test_formla_with_decimal_and_E                                 | 小数とEが含む式                             | 準正常系  | screen.set("1.2E3")<br/>monkeypatch.setattr("input_handler.format_result", lambda expr: "1200")                                                | =                 | 1200               |        |    |
| 79  | test_formula_with_decimal_exponent                             | Eと指数部に小数を含む式                         | 準正常系  | screen.set("2E0.5")<br/>monkeypatch.setattr("input_handler.format_result", lambda expr: "10")                                                  | =                 | 10                 |        |    |
| 80  | test_reinput_E_formula                                         | Eを含む式を評価後、Eを再入力                      | 正常系   | screen.set("3E3")<br/>handle_input("=", screen, state)<br/>assert state.just_evaluated is True                                                 | E                 | 3000E              |        |    |
| 81  | test_invalid_expression_with_E                                 | Eを含む無効な文字列                           | 準正常系  | AbcE+D                                                                                                                                         | =                 | エラー                |        |    |
| 82  | test_operator_input                                            | 演算子("+-*/%.^")入力(単独)                 | 正常系   | ""(空文字)                                                                                                                                        | +                 | ""(無視)             |        |    |
| 83  | test_operator_input_number                                     | 演算子入力(数字の後)                          | 正常系   | 2                                                                                                                                              | +                 | 2+                 |        |    |
| 84  | test_multiple_operators_input_number                           | 演算子連続入力(数字の後)                        | 準正常系  | 2+                                                                                                                                             | *                 | 2*                 |        |    |
| 85  | test_operator_input_open_parenthesis                           | 演算子入力(前括弧の後)                         | 準正常系  | (                                                                                                                                              | +                 | (+                 |        |    |
| 86  | test_operator_input_close_parenthesis                          | 演算子入力(後括弧の後)                         | 正常系   | (2+3)                                                                                                                                          | +                 | (2+3)+             |        |    |
| 87  | test_operator_input_evaluation                                 | 演算子入力(評価後)                           | 正常系   | screen.set("2+3") <br/>handle_input("=", screen, state)<br/>assert state.just_evaluated is True                                                | /                 | 5/                 |        |    |
| 88  | test_operator_input_invalid_expression                         | 演算子入力(無効な文字列式の後)                     | 準正常系  | Abc                                                                                                                                            | -                 | エラー                | Abc-   | NG |
| 89  | test_initial_evaluated_flag                                    | 初期化のフラグ確認                            | 正常系   | CalculatorState                                                                                                                                | なし                | False              |        |    |
| 90  | test_reset_evaluated_sets_flag_false                           | フラグをFalseに変更(reset_evaluated()の動作確認) | 正常系   | True                                                                                                                                           | reset_evaluated() | False              |        |    |
| 91  | test_evaluated_flag_true_after_equal_input                     | イコール入力後にフラグがTrueに変更                  | 正常系   | screen, state = ””, False<br/>screen.set("1+2")                                                                                                | =                 | True               |        |    |
| 92  | test_evaluated_flag_true_after_percent_conversion              | パーセント変換後にフラグがTrueに変更                 | 正常系   | 2                                                                                                                                              | %                 | True               |        |    |
| 93  | test_evaluated_flag_false_after_number_input                   | 数値入力後にFalseに変更                       | 正常系   | screen.set("")<br/>state.just_evaluated = True                                                                                                 | 1                 | False              |        |    |
| 94  | test_evaluated_flag_false_after_sqrt_input                     | √入力後にFalseに変更                        | 正常系   | screen.set("")<br/>state.just_evaluated = True                                                                                                 | √                 | False              |        |    |
| 95  | test_evaluated_flag_false_after_open_parenthesis               | (入力後にFalseに変更                        | 正常系   | screen.set("")<br/>state.just_evaluated = True                                                                                                 | (                 | False              |        |    |
| 96  | test_evaluated_flag_false_after_E_input                        | E入力後にFalseに変更                        | 正常系   | screen.set("2")<br/>state.just_evaluated = True                                                                                                | E                 | False              |        |    |
| 97  | test_evaluated_flag_unchanged_after_toggle_sign                | ±入力してもフラグ変化なし                        | 正常系   | screen.set("3")<br/>state.just_evaluated = True                                                                                                | ±                 | True               |        |    |
| 98  | test_evaluated_flag_false_after_number_input_post_evaluation   | 評価後、数字入力でフラグがfalseに変更                | 正常系   | screen.set("3+4")<br/>handle_input("=", screen, state)<br/>assert state.just_evaluated is True                                                 | 1                 | False              |        |    |
| 99  | test_evaluated_flag_false_after_operator_input_post_evaluation | 評価後、演算子入力でフラグがfalseに変更               | 正常系   | screen.set("3+5")<br/>handle_input("=", screen, state)<br/>assert state.just_evaluated is True                                                 | /                 | False              |        |    |
| 100 | test_evaluated_flag_false_after_clear_input_post_evaluation    | 評価後、クリア入力でフラグがfalseに変更               | 正常系   | screen.set("3+6")<br/>handle_input("=", screen, state)<br/>assert state.just_evaluated is True                                                 | C                 | False              |        |    |
| 101 | test_is_last_char_E                                            | 文字列の最後がEと判断                          | 正常系   | assert after_E("12E") is True                                                                                                                  | 12E               | True               |        |    |
| 102 | test_is_last_char_not_E                                        | 文字列の最後がEではないと判断                      | 正常系   | assert after_E("12E+") is False                                                                                                                | 12E+              | False              |        |    |
| 103 | test_is_last_char_E_plus                                       | 文字列の最後がE+と判断                         | 正常系   | assert after_E_operator("12E+") is True                                                                                                        | 12E+              | True               |        |    |
| 104 | test_is_last_char_E_minus                                      | 文字列の最後がE-と判断                         | 正常系   | assert after_E_operator("12E-") is True                                                                                                        | 12E-              | True               |        |    |
| 105 | test_is_last_char_not_E_plus_or_minus                          | 文字列の最後がE+もしくはE-ではないと判断               | 正常系   | assert after_E_operator("12E") is False                                                                                                        | 12E               | False              |	


- 対象ファイル:keisan.py 


- 対象ファイル:utils.py テストファイル:test_utils.py
![alt text](image-5.png)
| No. | テスト関数                               | テスト項目名              | テスト観点 | 事前条件(初期値)                                            | 入力値 | 期待結果 | 実行結果 | 判定 |
|-----|-------------------------------------|---------------------|-------|------------------------------------------------------|-----|------|------|----|
| 1   | test_format_result                  | 結果が整数に整形できる場合、整数に変換 | 正常系   | def mock_全体計算(expr):<br/>    return "24.0"           | 3*8 | 24   | 25   | OK |
| 2   | test_format_result_float            | 結果が小数の場合、小数で表示      | 正常系   | def mock_全体計算(expr):<br/>    return "1.25"           | 5/4 | 1.25 | 1.26 | OK |
| 3   | test_format_result_error_on_invalid | 数値の変換ができない文字列       | 準正常系  | def mock_全体計算(expr):<br/>    return "Abc"            | Abc | エラー  | エラー  | OK |
| 4   | test_format_exception               | 例外処理                | 準正常系  | def mock_全体計算(expr):<br/>    raise ValueError("エラー") | 1/0 | エラー  | エラー  | OK |


### 3.2 統合テスト一覧

| 項目     | 実施内容                                                       | 入力内容          | 結果                   | 判定 | 補足                                                                                                                               |
|----------|----------------------------------------------------------------|-------------------|------------------------|------|------------------------------------------------------------------------------------------------------------------------------------|
| 足し算   | 数字２つの足し算                                               | 1+1               | 2                      | OK   |                                                                                                                                    |
| 足し算   | 数字３つの足し算                                               | 1+1+1             | 3                      | OK   |                                                                                                                                    |
| 足し算   | 数字３つの足し算と引き算                                       | 7+6-2             | 11                     | OK   |                                                                                                                                    |
| 足し算   | 数字２桁の足し算                                               | 101+10            | 111                    | OK   |                                                                                                                                    |
| 足し算   | 小数点の足し算                                                 | 1.1+2.2           | 3.3                    | OK   |                                                                                                                                    |
| 引き算   | 数字２つの引き算                                               | 5-2               | 3                      | OK   |                                                                                                                                    |
| 引き算   | 数字２つの引き算                                               | 5-3-2             | 0                      | OK   |                                                                                                                                    |
| 引き算   | 数字２つの引き算(結果がマイナスになる）                        | 5-10              | -5                     | OK   |                                                                                                                                    |
| 引き算   | 小数点の引き算                                                 | 1.2-3.3           | -2.1                   | OK   |                                                                                                                                    |
| 引き算   | 数字２つの引き算                                               | 10-100            | 90                     | OK   |                                                                                                                                    |
| 掛け算   | 数字２つの掛け算                                               | 5*5               | 25                     | OK   |                                                                                                                                    |
| 掛け算   | 数字３つの掛け算                                               | 2*2*2             | 8                      | OK   |                                                                                                                                    |
| 掛け算   | 数字２桁の掛け算                                               | 50*22             | 1100                   | OK   |                                                                                                                                    |
| 掛け算   | 小数点の掛け算                                                 | 1.1*2-2           | 0.2                    | OK   |                                                                                                                                    |
| 掛け算   | マイナスの掛け算                                               | 5*(-5)            | -25                    | OK   |                                                                                                                                    |
| 割り算   | 数字２つの割り算                                               | 1/2               | 0.5                    | OK   |                                                                                                                                    |
| 割り算   | 数字２つの割り算(割り切れない                                  | 1/3               | 0.333333333            | OK   |                                                                                                                                    |
| 割り算   | 数字２桁の割り算                                               | 90/50             | 1.8                    | OK   |                                                                                                                                    |
| 割り算   | 小数点の割り算                                                 | 1.5/2             | 0.75                   | OK   |                                                                                                                                    |
| 10の指数 | 指数表示                                                       | 1E5               | 100000                 | OK   | 計算結果の桁あふれの時に指数が使われないのは直せたら直したいなぁ                                                                   |
| 10の指数 | 指数表示                                                       | 1E5 + 1           | エラー                 | NG   | 指数表示に演算子が加わるとすべてエラー                                                                                             |
| 乗数     | 乗数の計算                                                     | 2^2^3             | 4096                   | OK   |                                                                                                                                    |
| √        | √の計算                                                        | √2                | 1.414213562            | OK   |                                                                                                                                    |
| √        | √の計算                                                        | 2+√2              | 3.414213562            | OK   |                                                                                                                                    |
| √        | √の計算                                                        | 2*√2              | 2.828427125            | OK   |                                                                                                                                    |
| √        | √の計算                                                        | √2^√2             | 1.632526919            | OK   |                                                                                                                                    |
| √        | √の計算                                                        | √2*2              | 2.828427125            | OK   |                                                                                                                                    |
| √        | √の計算                                                        | √2+2              | 3.414213562            | OK   |                                                                                                                                    |
|          |                                                                |                   |                        |      |                                                                                                                                    |
|          |                                                                |                   |                        |      |                                                                                                                                    |
| その他   | クリアを押下                                                   | -                 | 文字が消えた           | OK   |                                                                                                                                    |
| その他   | 演算子の後にバックスペースが効かない                           |                   |                        | NG   | 修正する                                                                                                                           |
| その他   | 数字が19桁以上入力できない                                     |                   |                        | OK   |                                                                                                                                    |
| その他   | 計算結果が19桁以上だと桁があふれる                             | 999999999999999^9 | 長すぎてコピーできない | NG   | 計算結果が19桁以上の場合は計算結果を返さずにエラーにすればいいのでは？      7^7^7だとinfで表示されてたから、チェックははいってる？ |
| その他   | ±のかっこを外すと、整数でもfloatになって表示されてしまっている |                   |                        | NG   | 一度直した気はする（戻ってる？                                                                                                     |
| その他   | 小数点がある状態で±を押すと表示がおかしくなる                  |                   |                        | NG   | 一度直した気はする（戻ってる？                                                                                                     |
| その他   | 数字の後に(を押す                                              |                   | 7*(へ変換される        | OK   |                                                                                                                                    |
| その他   | 数字の後に)を押す                                              |                   | 入力されない           | OK   |                                                                                                                                    |
| その他   | Windowサイズの最大化は無効にしてもよいと思う                   |                   |                        | -    | 最大化できる意味もないので無効にしてもよいかもしれない                                                                             |
| その他   | 小数点を使った計算不可能な値が入力できていないか               |                   | 1.5.5.5.5              | NG   | 計算結果はNGを返しているが入力できないほうがいい                                                                                   |
